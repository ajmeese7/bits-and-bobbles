<h1 id="encodedpayload"><a aria-hidden="true" class="anchor-heading icon-link" href="#encodedpayload"></a>EncodedPayload</h1>
<p>Tried making the binary an executable and executing it:</p>
<pre class="language-shell"><code class="language-shell"><span class="token function">chmod</span> +x ./encodedpayload
./encodedpayload
</code></pre>
<p>But it silently failed. Running it with <code>strace</code> showed that it was trying to connect to localhost:</p>
<pre class="language-log"><code class="language-log"><span class="token operator">$</span> strace <span class="token file-path string">./encodedpayload</span>
execve<span class="token operator">(</span><span class="token string">"./encodedpayload"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"./encodedpayload"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0x7ffd52e05a00</span> <span class="token operator">/</span><span class="token operator">*</span> <span class="token number">84</span> vars <span class="token operator">*</span><span class="token operator">/</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token property">strace:</span> <span class="token punctuation">[</span> Process PID<span class="token operator">=</span><span class="token number">479009</span> runs in <span class="token number">32</span> bit mode<span class="token punctuation">.</span> <span class="token punctuation">]</span>
socket<span class="token operator">(</span>AF_INET<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">,</span> IPPROTO_IP<span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">3</span>
dup2<span class="token operator">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">)</span>                              <span class="token operator">=</span> <span class="token number">2</span>
dup2<span class="token operator">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">)</span>                              <span class="token operator">=</span> <span class="token number">1</span>
dup2<span class="token operator">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">)</span>                              <span class="token operator">=</span> <span class="token number">0</span>
connect<span class="token operator">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">{</span>sa_family<span class="token operator">=</span>AF_INET<span class="token punctuation">,</span> sin_port<span class="token operator">=</span>htons<span class="token operator">(</span><span class="token number">1337</span><span class="token operator">)</span><span class="token punctuation">,</span> sin_addr<span class="token operator">=</span>inet_addr<span class="token operator">(</span><span class="token string">"127.0.0.1"</span><span class="token operator">)</span><span class="token operator">}</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> ECONNREFUSED <span class="token operator">(</span>Connection refused<span class="token operator">)</span>
syscall_0xffffffffffffff0b<span class="token operator">(</span><span class="token number">0xff907188</span><span class="token punctuation">,</span> <span class="token number">0xff907180</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> ENOSYS <span class="token operator">(</span>Function not implemented<span class="token operator">)</span>
execve<span class="token operator">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span> <span class="token string">"-c"</span><span class="token punctuation">,</span> <span class="token string">"echo HTB{PLz_strace_M333}"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token property">strace:</span> <span class="token punctuation">[</span> Process PID<span class="token operator">=</span><span class="token number">479009</span> runs in <span class="token number">64</span> bit mode<span class="token punctuation">.</span> <span class="token punctuation">]</span>
brk<span class="token operator">(</span><span class="token boolean">NULL</span><span class="token operator">)</span>                               <span class="token operator">=</span> <span class="token number">0x56187162a000</span>
arch_prctl<span class="token operator">(</span><span class="token number">0x3001</span> <span class="token operator">/</span><span class="token operator">*</span> ARCH_<span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span> <span class="token operator">*</span><span class="token operator">/</span><span class="token punctuation">,</span> <span class="token number">0x7ffe62905c70</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> EINVAL <span class="token operator">(</span>Invalid argument<span class="token operator">)</span>
access<span class="token operator">(</span><span class="token string">"/etc/ld.so.preload"</span><span class="token punctuation">,</span> R_OK<span class="token operator">)</span>      <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> ENOENT <span class="token operator">(</span>No such file or directory<span class="token operator">)</span>
openat<span class="token operator">(</span>AT_FDCWD<span class="token punctuation">,</span> <span class="token string">"/etc/ld.so.cache"</span><span class="token punctuation">,</span> O_RDONLY<span class="token operator">|</span>O_CLOEXEC<span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">4</span>
fstat<span class="token operator">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">{</span>st_mode<span class="token operator">=</span>S_IFREG<span class="token operator">|</span><span class="token number">0644</span><span class="token punctuation">,</span> st_size<span class="token operator">=</span><span class="token number">149062</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">}</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
mmap<span class="token operator">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">149062</span><span class="token punctuation">,</span> PROT_READ<span class="token punctuation">,</span> MAP_PRIVATE<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0x7f264331a000</span>
close<span class="token operator">(</span><span class="token number">4</span><span class="token operator">)</span>                                <span class="token operator">=</span> <span class="token number">0</span>
openat<span class="token operator">(</span>AT_FDCWD<span class="token punctuation">,</span> <span class="token string">"/lib/x86_64-linux-gnu/libc.so.6"</span><span class="token punctuation">,</span> O_RDONLY<span class="token operator">|</span>O_CLOEXEC<span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">4</span>
read<span class="token operator">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\300A\2\0\0\0\0\0"</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">832</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">832</span>
pread64<span class="token operator">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0"</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">784</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">784</span>
pread64<span class="token operator">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"\4\0\0\0\20\0\0\0\5\0\0\0GNU\0\2\0\0\300\4\0\0\0\3\0\0\0\0\0\0\0"</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">848</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">32</span>
pread64<span class="token operator">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"\4\0\0\0\24\0\0\0\3\0\0\0GNU\0\30x\346\264ur\f|Q\226\236i\253-'o"</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">880</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">68</span>
fstat<span class="token operator">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token operator">{</span>st_mode<span class="token operator">=</span>S_IFREG<span class="token operator">|</span><span class="token number">0755</span><span class="token punctuation">,</span> st_size<span class="token operator">=</span><span class="token number">2029592</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">}</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
mmap<span class="token operator">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">8192</span><span class="token punctuation">,</span> PROT_READ<span class="token operator">|</span>PROT_WRITE<span class="token punctuation">,</span> MAP_PRIVATE<span class="token operator">|</span>MAP_ANONYMOUS<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0x7f2643318000</span>
pread64<span class="token operator">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0"</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">784</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">784</span>
pread64<span class="token operator">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"\4\0\0\0\20\0\0\0\5\0\0\0GNU\0\2\0\0\300\4\0\0\0\3\0\0\0\0\0\0\0"</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">848</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">32</span>
pread64<span class="token operator">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"\4\0\0\0\24\0\0\0\3\0\0\0GNU\0\30x\346\264ur\f|Q\226\236i\253-'o"</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">880</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">68</span>
mmap<span class="token operator">(</span><span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">2037344</span><span class="token punctuation">,</span> PROT_READ<span class="token punctuation">,</span> MAP_PRIVATE<span class="token operator">|</span>MAP_DENYWRITE<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0x7f2643126000</span>
mmap<span class="token operator">(</span><span class="token number">0x7f2643148000</span><span class="token punctuation">,</span> <span class="token number">1540096</span><span class="token punctuation">,</span> PROT_READ<span class="token operator">|</span>PROT_EXEC<span class="token punctuation">,</span> MAP_PRIVATE<span class="token operator">|</span>MAP_FIXED<span class="token operator">|</span>MAP_DENYWRITE<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0x22000</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0x7f2643148000</span>
mmap<span class="token operator">(</span><span class="token number">0x7f26432c0000</span><span class="token punctuation">,</span> <span class="token number">319488</span><span class="token punctuation">,</span> PROT_READ<span class="token punctuation">,</span> MAP_PRIVATE<span class="token operator">|</span>MAP_FIXED<span class="token operator">|</span>MAP_DENYWRITE<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0x19a000</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0x7f26432c0000</span>
mmap<span class="token operator">(</span><span class="token number">0x7f264330e000</span><span class="token punctuation">,</span> <span class="token number">24576</span><span class="token punctuation">,</span> PROT_READ<span class="token operator">|</span>PROT_WRITE<span class="token punctuation">,</span> MAP_PRIVATE<span class="token operator">|</span>MAP_FIXED<span class="token operator">|</span>MAP_DENYWRITE<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0x1e7000</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0x7f264330e000</span>
mmap<span class="token operator">(</span><span class="token number">0x7f2643314000</span><span class="token punctuation">,</span> <span class="token number">13920</span><span class="token punctuation">,</span> PROT_READ<span class="token operator">|</span>PROT_WRITE<span class="token punctuation">,</span> MAP_PRIVATE<span class="token operator">|</span>MAP_FIXED<span class="token operator">|</span>MAP_ANONYMOUS<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0x7f2643314000</span>
close<span class="token operator">(</span><span class="token number">4</span><span class="token operator">)</span>                                <span class="token operator">=</span> <span class="token number">0</span>
arch_prctl<span class="token operator">(</span>ARCH_SET_FS<span class="token punctuation">,</span> <span class="token number">0x7f2643319580</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
mprotect<span class="token operator">(</span><span class="token number">0x7f264330e000</span><span class="token punctuation">,</span> <span class="token number">16384</span><span class="token punctuation">,</span> PROT_READ<span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
mprotect<span class="token operator">(</span><span class="token number">0x56186fc4b000</span><span class="token punctuation">,</span> <span class="token number">8192</span><span class="token punctuation">,</span> PROT_READ<span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
mprotect<span class="token operator">(</span><span class="token number">0x7f264336c000</span><span class="token punctuation">,</span> <span class="token number">4096</span><span class="token punctuation">,</span> PROT_READ<span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
munmap<span class="token operator">(</span><span class="token number">0x7f264331a000</span><span class="token punctuation">,</span> <span class="token number">149062</span><span class="token operator">)</span>          <span class="token operator">=</span> <span class="token number">0</span>
getuid<span class="token operator">(</span><span class="token operator">)</span>                                <span class="token operator">=</span> <span class="token number">1000</span>
getgid<span class="token operator">(</span><span class="token operator">)</span>                                <span class="token operator">=</span> <span class="token number">1000</span>
getpid<span class="token operator">(</span><span class="token operator">)</span>                                <span class="token operator">=</span> <span class="token number">479009</span>
rt_sigaction<span class="token operator">(</span>SIGCHLD<span class="token punctuation">,</span> <span class="token operator">{</span>sa_handler<span class="token operator">=</span><span class="token number">0x56186fc40c30</span><span class="token punctuation">,</span> sa_mask<span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">[</span>RTMIN RT_1<span class="token punctuation">]</span><span class="token punctuation">,</span> sa_flags<span class="token operator">=</span>SA_RESTORER<span class="token punctuation">,</span> sa_restorer<span class="token operator">=</span><span class="token number">0x7f2643169090</span><span class="token operator">}</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
geteuid<span class="token operator">(</span><span class="token operator">)</span>                               <span class="token operator">=</span> <span class="token number">1000</span>
getppid<span class="token operator">(</span><span class="token operator">)</span>                               <span class="token operator">=</span> <span class="token number">479006</span>
brk<span class="token operator">(</span><span class="token boolean">NULL</span><span class="token operator">)</span>                               <span class="token operator">=</span> <span class="token number">0x56187162a000</span>
brk<span class="token operator">(</span><span class="token number">0x56187164b000</span><span class="token operator">)</span>                     <span class="token operator">=</span> <span class="token number">0x56187164b000</span>
getcwd<span class="token operator">(</span><span class="token string">"/home/aaron/Downloads/HTB/rev_encodedpayload"</span><span class="token punctuation">,</span> <span class="token number">4096</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">45</span>
geteuid<span class="token operator">(</span><span class="token operator">)</span>                               <span class="token operator">=</span> <span class="token number">1000</span>
getegid<span class="token operator">(</span><span class="token operator">)</span>                               <span class="token operator">=</span> <span class="token number">1000</span>
rt_sigaction<span class="token operator">(</span>SIGINT<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token operator">{</span>sa_handler<span class="token operator">=</span>SIG_DFL<span class="token punctuation">,</span> sa_mask<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sa_flags<span class="token operator">=</span><span class="token number">0</span><span class="token operator">}</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
rt_sigaction<span class="token operator">(</span>SIGINT<span class="token punctuation">,</span> <span class="token operator">{</span>sa_handler<span class="token operator">=</span><span class="token number">0x56186fc40c30</span><span class="token punctuation">,</span> sa_mask<span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">[</span>RTMIN RT_1<span class="token punctuation">]</span><span class="token punctuation">,</span> sa_flags<span class="token operator">=</span>SA_RESTORER<span class="token punctuation">,</span> sa_restorer<span class="token operator">=</span><span class="token number">0x7f2643169090</span><span class="token operator">}</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
rt_sigaction<span class="token operator">(</span>SIGQUIT<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token operator">{</span>sa_handler<span class="token operator">=</span>SIG_DFL<span class="token punctuation">,</span> sa_mask<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sa_flags<span class="token operator">=</span><span class="token number">0</span><span class="token operator">}</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
rt_sigaction<span class="token operator">(</span>SIGQUIT<span class="token punctuation">,</span> <span class="token operator">{</span>sa_handler<span class="token operator">=</span>SIG_DFL<span class="token punctuation">,</span> sa_mask<span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">[</span>RTMIN RT_1<span class="token punctuation">]</span><span class="token punctuation">,</span> sa_flags<span class="token operator">=</span>SA_RESTORER<span class="token punctuation">,</span> sa_restorer<span class="token operator">=</span><span class="token number">0x7f2643169090</span><span class="token operator">}</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
rt_sigaction<span class="token operator">(</span>SIGTERM<span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token operator">{</span>sa_handler<span class="token operator">=</span>SIG_DFL<span class="token punctuation">,</span> sa_mask<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sa_flags<span class="token operator">=</span><span class="token number">0</span><span class="token operator">}</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
rt_sigaction<span class="token operator">(</span>SIGTERM<span class="token punctuation">,</span> <span class="token operator">{</span>sa_handler<span class="token operator">=</span>SIG_DFL<span class="token punctuation">,</span> sa_mask<span class="token operator">=</span><span class="token operator">~</span><span class="token punctuation">[</span>RTMIN RT_1<span class="token punctuation">]</span><span class="token punctuation">,</span> sa_flags<span class="token operator">=</span>SA_RESTORER<span class="token punctuation">,</span> sa_restorer<span class="token operator">=</span><span class="token number">0x7f2643169090</span><span class="token operator">}</span><span class="token punctuation">,</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token operator">)</span> <span class="token operator">=</span> <span class="token number">0</span>
write<span class="token operator">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"HTB{PLz_strace_M333}\n"</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token operator">)</span>  <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span> EPIPE <span class="token operator">(</span>Broken pipe<span class="token operator">)</span>
<span class="token separator comment">---</span> SIGPIPE <span class="token operator">{</span>si_signo<span class="token operator">=</span>SIGPIPE<span class="token punctuation">,</span> si_code<span class="token operator">=</span>SI_USER<span class="token punctuation">,</span> si_pid<span class="token operator">=</span><span class="token number">479009</span><span class="token punctuation">,</span> si_uid<span class="token operator">=</span><span class="token number">1000</span><span class="token operator">}</span> <span class="token separator comment">---</span>
<span class="token operator">+</span><span class="token operator">+</span><span class="token operator">+</span> killed by SIGPIPE <span class="token operator">+</span><span class="token operator">+</span><span class="token operator">+</span>
</code></pre>
<p>And as you can see, the flag was <code>HTB{PLz_strace_M333}</code>.</p>